<!DOCTYPE html> <!-- Declares this as an HTML5 document -->
<html>
    <head>
        <title>
            Get Started - SafePort <!-- Page title shown in browser tab -->
        </title>
        <link rel="stylesheet" href="style.css"> <!-- Links external CSS file for styling -->
    </head>

<body>
<!-- Floating particles -->
<div class="particles">
  <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
  <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
  <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
  <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
  <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
  <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
  <div class="particle" style="left: 70%; animation-delay: 2s;"></div>
  <div class="particle" style="left: 80%; animation-delay: 1s;"></div>
  <div class="particle" style="left: 90%; animation-delay: 3s;"></div>
</div>

<!-- Floating security icons -->
<div class="security-icons">
  <div class="floating-padlock">
    <div class="padlock">
      <div class="shackle"></div>
      <div class="body">
        <div class="keyhole"></div>
      </div>
    </div>
  </div>
  <div class="floating-padlock">
    <div class="padlock">
      <div class="shackle"></div>
      <div class="body">
        <div class="keyhole"></div>
      </div>
    </div>
  </div>
  <div class="floating-padlock">
    <div class="padlock">
      <div class="shackle"></div>
      <div class="body">
        <div class="keyhole"></div>
      </div>
    </div>
  </div>
  <div class="floating-padlock">
    <div class="padlock">
      <div class="shackle"></div>
      <div class="body">
        <div class="keyhole"></div>
      </div>
    </div>
  </div>
  <div class="floating-padlock">
    <div class="padlock">
      <div class="shackle"></div>
      <div class="body">
        <div class="keyhole"></div>
      </div>
    </div>
  </div>
</div>

<!-- Navigation bar for easy access to other pages -->
<nav class="navbar">
  <div class="navdiv">
    <div class="logo"><a href="home.html"><span class="safe">Safe</span><span class="port">Port</span></a></div>
    <ul>
      <li><a href="home.html">Home</a></li>
      <li><a href="Services.html">Services</a></li>
      <li><a href="About.html">About</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
  </div>
</nav>

<!-- Main container that holds both forms and overlay -->
<div class="auth-container">
<div class="container" id="container">
  
  <!-- Sign In Form Container (initially visible on left) -->
  <div class="form-container sign-in-container">
    <form id="loginForm">
      <h2>Sign In</h2>
      <input type="email" id="loginEmail" placeholder="Email" required />
      <button type="submit">Log In</button>
      <div id="loginMessage" class="message"></div>
    </form>
  </div>
  
  <!-- Sign Up Form Container (initially hidden on right) -->
  <div class="form-container sign-up-container">
    <form id="signupForm">
      <h2>Create Account</h2>
      <input type="text" id="signupName" placeholder="Full Name" required />
      <input type="email" id="signupEmail" placeholder="Email" required />
      <input type="text" id="signupCompany" placeholder="Company (Optional)" />
      <select id="signupSecurityLevel" required>
        <option value="">Select Security Level</option>
        <option value="Low">Low</option>
        <option value="Medium">Medium</option>
        <option value="High">High</option>
      </select>
      <textarea id="signupConcerns" placeholder="Security Concerns (Optional)" rows="3"></textarea>
      <label class="checkbox-label">
        <input type="checkbox" id="signupNewsletter" />
        Subscribe to newsletter
      </label>
      <button type="submit">Sign Up</button>
      <div id="signupMessage" class="message"></div>
    </form>
  </div>
  
  <!-- Overlay Container (blue sliding panel) -->
  <div class="overlay-container">
    <div class="overlay"> <!-- Blue gradient background -->
      
      <!-- Right overlay panel (visible when sign-in form is shown) -->
      <div class="overlay-panel overlay-right">
        <h2>Welcome!</h2> <!-- Greeting for new users -->
        <p>If you do not have an account, sign up here.</p> <!-- Instructions -->
        <button class="ghost" id="signUpToggle" type="button">Sign Up</button> <!-- Button to switch to signup -->
      </div>
      
      <!-- Left overlay panel (visible when sign-up form is shown) -->
      <div class="overlay-panel overlay-left">
        <h2>Welcome Back!</h2> <!-- Greeting for existing users -->
        <p>If you already have an account, log in here.</p> <!-- Instructions -->
        <button class="ghost" id="signInToggle" type="button">Log In</button> <!-- Button to switch to login -->
      </div>
      
    </div>
  </div>
</div>
</div>

<script>
  // Get references to DOM elements
  const container = document.getElementById('container');
  const signUpButton = document.getElementById('signUpToggle');
  const signInButton = document.getElementById('signInToggle');
  const signupForm = document.getElementById('signupForm');
  const loginForm = document.getElementById('loginForm');

  // Panel switching functionality
  signUpButton.addEventListener('click', () => {
    container.classList.add('right-panel-active');
  });

  signInButton.addEventListener('click', () => {
    container.classList.remove('right-panel-active');
  });

  // Sign Up Form Handler
  signupForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = {
      fullName: document.getElementById('signupName').value,
      email: document.getElementById('signupEmail').value,
      company: document.getElementById('signupCompany').value,
      securityLevel: document.getElementById('signupSecurityLevel').value,
      concerns: document.getElementById('signupConcerns').value,
      newsletter: document.getElementById('signupNewsletter').checked
    };

    try {
      const response = await fetch('/api/users/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData)
      });

      const result = await response.json();
      const messageDiv = document.getElementById('signupMessage');

      if (result.success) {
        messageDiv.innerHTML = '<span style="color: #4CAF50;">✅ Account created successfully!</span>';
        signupForm.reset();
        // Auto-switch to login panel after successful signup
        setTimeout(() => {
          container.classList.remove('right-panel-active');
          messageDiv.innerHTML = '';
        }, 2000);
      } else {
        messageDiv.innerHTML = '<span style="color: #f44336;">❌ Registration failed. Please try again.</span>';
      }
    } catch (error) {
      document.getElementById('signupMessage').innerHTML = '<span style="color: #f44336;">❌ Network error. Please try again.</span>';
    }
  });

  // Login Form Handler
  loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const email = document.getElementById('loginEmail').value;

    try {
      const response = await fetch('/api/users/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email })
      });

      const result = await response.json();
      const messageDiv = document.getElementById('loginMessage');

      if (result.success) {
        messageDiv.innerHTML = '<span style="color: #4CAF50;">✅ Welcome back, ' + result.user.full_name + '!</span>';
        // Redirect to dashboard or home page after successful login
        setTimeout(() => {
          window.location.href = 'home.html';
        }, 1500);
      } else {
        messageDiv.innerHTML = '<span style="color: #f44336;">❌ No account found with this email.</span>';
      }
    } catch (error) {
      document.getElementById('loginMessage').innerHTML = '<span style="color: #f44336;">❌ Network error. Please try again.</span>';
    }
  });
</script>
    </body>
</html>